<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wang Language - Interactive Playground</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0f;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-dim: rgba(255, 255, 255, 0.5);
            --accent-primary: #6366f1;
            --accent-secondary: #a78bfa;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
            --code-bg: rgba(10, 10, 15, 0.6);
            --shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
            position: relative;
        }

        /* Animated gradient background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(99, 102, 241, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(167, 139, 250, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(236, 72, 153, 0.2) 0%, transparent 50%);
            animation: gradientShift 20s ease infinite;
            z-index: -2;
        }

        @keyframes gradientShift {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(-20px, 10px) rotate(1deg); }
            50% { transform: translate(20px, -10px) rotate(-1deg); }
            75% { transform: translate(-10px, -20px) rotate(1deg); }
        }

        /* Glassmorphism container */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
            animation: fadeInUp 0.8s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }

        .logo-container {
            display: inline-flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.5rem;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
            animation: pulse 3s ease infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .tagline {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        /* Navigation buttons */
        .nav-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 0.75rem 1.5rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 500;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.2);
        }

        /* Main layout */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        /* Editor and output panels */
        .panel {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            backdrop-filter: blur(20px);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-height: 500px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 35px -5px rgba(0, 0, 0, 0.15);
        }

        .panel-header {
            padding: 1.25rem 1.5rem;
            background: rgba(255, 255, 255, 0.03);
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-title {
            font-weight: 600;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .panel-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Code editor and output */
        .editor-container, .output-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        #editor, #output {
            width: 100%;
            height: 100%;
            padding: 1.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            background: var(--code-bg);
            color: var(--text-primary);
            border: none;
            outline: none;
            resize: none;
            tab-size: 2;
        }

        #editor {
            color: #e2e8f0;
        }

        #output {
            background: rgba(10, 10, 15, 0.8);
        }

        /* Control panel */
        .controls {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 1.5rem;
            backdrop-filter: blur(20px);
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-family: inherit;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--accent-primary);
        }

        /* Status indicator */
        .status {
            margin-left: auto;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: blink 1.5s ease infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status.success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .status.success .status-indicator {
            background: var(--success);
        }

        .status.error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .status.error .status-indicator {
            background: var(--error);
        }

        .status.loading {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .status.loading .status-indicator {
            background: var(--warning);
        }

        /* Examples selector */
        .examples-selector {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 0.5rem 1rem;
            color: var(--text-primary);
            font-family: inherit;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .examples-selector:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent-primary);
        }

        /* Quick examples grid */
        .examples-section {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(20px);
            margin-bottom: 3rem;
        }

        .examples-section h2 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .example-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .example-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .example-card:hover::before {
            transform: translateX(0);
        }

        .example-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.1);
        }

        .example-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .example-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 3rem 0;
            color: var(--text-secondary);
        }

        footer a {
            color: var(--accent-primary);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        footer a:hover {
            color: var(--accent-secondary);
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .main-content {
                gap: 1rem;
            }

            .controls {
                padding: 1rem;
            }

            .btn {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
            }

            .examples-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Loading spinner */
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Tooltips */
        .tooltip {
            position: relative;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 0.5rem 1rem;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            font-size: 0.85rem;
            border-radius: 8px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            margin-bottom: 0.5rem;
        }

        .tooltip:hover::after {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo">W</div>
                <h1>Wang Playground</h1>
            </div>
            <p class="tagline">Interactive CSP-Safe Workflow Programming Environment</p>
            <div class="nav-buttons">
                <a href="/" class="nav-btn">
                    <span>📚</span>
                    <span>Documentation</span>
                </a>
                <a href="https://github.com/artpar/wang" class="nav-btn" target="_blank">
                    <span>⭐</span>
                    <span>GitHub</span>
                </a>
                <a href="https://www.npmjs.com/package/wang-lang" class="nav-btn" target="_blank">
                    <span>📦</span>
                    <span>NPM Package</span>
                </a>
            </div>
        </header>

        <div class="main-content">
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <span class="panel-icon">✏️</span>
                        <span>Code Editor</span>
                    </div>
                    <select class="examples-selector" id="examples">
                        <option value="">Load Example...</option>
                        <option value="hello">Hello World</option>
                        <option value="variables">Variables & Scoping</option>
                        <option value="functions">Functions & Arrows</option>
                        <option value="pipelines">Pipeline Operators</option>
                        <option value="classes">Classes & OOP</option>
                        <option value="async">Async/Await</option>
                        <option value="destructuring">Destructuring</option>
                        <option value="optional">Optional Chaining</option>
                        <option value="modules">Module System</option>
                    </select>
                </div>
                <div class="editor-container">
                    <textarea id="editor" spellcheck="false" placeholder="// Welcome to Wang Playground!
// Start typing your code here or load an example...

let message = &quot;Hello, Wang!&quot;
log(message)

// Try pipeline operators
[1, 2, 3, 4, 5]
  |> filter(_, n => n > 2)
  |> map(_, n => n * 2)
  |> reduce(_, (a, b) => a + b, 0)"></textarea>
                </div>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <span class="panel-icon">📋</span>
                        <span>Output Console</span>
                    </div>
                    <button class="btn btn-secondary" onclick="clearOutput()">
                        Clear
                    </button>
                </div>
                <div class="output-container">
                    <textarea id="output" readonly spellcheck="false" placeholder="Output will appear here when you run your code..."></textarea>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn btn-primary tooltip" onclick="runCode()" data-tooltip="Execute code (Ctrl+Enter)">
                <span>▶️</span>
                <span>Run Code</span>
            </button>
            <button class="btn btn-secondary tooltip" onclick="validateCode()" data-tooltip="Check syntax without running">
                <span>✅</span>
                <span>Validate</span>
            </button>
            <button class="btn btn-secondary tooltip" onclick="showAST()" data-tooltip="View Abstract Syntax Tree">
                <span>🌳</span>
                <span>Show AST</span>
            </button>
            <span id="status" class="status" style="display: none;">
                <span class="status-indicator"></span>
                <span id="status-text">Ready</span>
            </span>
        </div>

        <div class="examples-section">
            <h2>Quick Examples</h2>
            <div class="examples-grid">
                <div class="example-card" onclick="loadExample('variables')">
                    <div class="example-title">Variables</div>
                    <div class="example-desc">let, const, var, scoping</div>
                </div>
                <div class="example-card" onclick="loadExample('functions')">
                    <div class="example-title">Functions</div>
                    <div class="example-desc">Regular & arrow functions</div>
                </div>
                <div class="example-card" onclick="loadExample('pipelines')">
                    <div class="example-title">Pipelines</div>
                    <div class="example-desc">|> and -> operators</div>
                </div>
                <div class="example-card" onclick="loadExample('classes')">
                    <div class="example-title">Classes</div>
                    <div class="example-desc">OOP with inheritance</div>
                </div>
                <div class="example-card" onclick="loadExample('async')">
                    <div class="example-title">Async/Await</div>
                    <div class="example-desc">Asynchronous operations</div>
                </div>
                <div class="example-card" onclick="loadExample('destructuring')">
                    <div class="example-title">Destructuring</div>
                    <div class="example-desc">Arrays & objects</div>
                </div>
                <div class="example-card" onclick="loadExample('optional')">
                    <div class="example-title">Optional Chaining</div>
                    <div class="example-desc">Safe property access</div>
                </div>
                <div class="example-card" onclick="loadExample('modules')">
                    <div class="example-title">Modules</div>
                    <div class="example-desc">Import & export</div>
                </div>
            </div>
        </div>

        <footer>
            <p>Made with ❤️ by the Wang Language team</p>
            <p>
                <a href="https://github.com/artpar/wang">GitHub</a> • 
                <a href="https://www.npmjs.com/package/wang-lang">NPM</a> • 
                <a href="/">Documentation</a>
            </p>
        </footer>
    </div>

    <!-- Use jsDelivr CDN to always get the latest wang-lang build from GitHub -->
    <!-- This automatically serves the latest version from the main branch -->
    <script src="https://cdn.jsdelivr.net/gh/artpar/wang@main/dist/browser/wang.min.js"></script>
    <script>
        // Example code snippets
        const examples = {
            hello: `// Hello World in Wang
let greeting = "Hello, World!"
log(greeting)

// String interpolation with template literals
let name = "Wang"
let message = \`Welcome to \${name} Language!\`
log(message)`,

            variables: `// Variable declarations
let mutable = 10
const immutable = 20
var hoisted = 30

// Block scoping
{
  let inner = 40
  log("Inner scope:", inner)
}

// Compound assignments
let x = 5
x += 10  // 15
x -= 3   // 12
x *= 2   // 24
x /= 4   // 6
log("Final x:", x)

// Increment/Decrement
let counter = 0
counter++
++counter
log("Counter:", counter)`,

            functions: `// Regular function
function add(a, b) {
  return a + b
}

// Arrow function
let multiply = (a, b) => a * b

// Higher-order function
function operate(x, y, operation) {
  return operation(x, y)
}

log("Add:", add(5, 3))
log("Multiply:", multiply(4, 6))
log("Operate:", operate(10, 5, (a, b) => a - b))

// Closures
function makeCounter() {
  let count = 0
  return () => {
    count++
    return count
  }
}

let counter = makeCounter()
log("Count:", counter())
log("Count:", counter())`,

            pipelines: `// Pipeline operators
let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

// Pipe operator |>
let result = numbers
  |> filter(_, n => n % 2 === 0)
  |> map(_, n => n * n)
  |> reduce(_, (sum, n) => sum + n, 0)

log("Sum of squares of even numbers:", result)

// Arrow operator ->
let data = { values: [1, 2, 3] }
data.values
  |> map(_, x => x * 10)
  -> forEach(_, x => log("Value:", x))

// Method chaining with pipelines
class DataProcessor {
  constructor(data) {
    this.data = data
  }
  
  filter(predicate) {
    this.data = filter(this.data, predicate)
    return this
  }
  
  transform(fn) {
    this.data = map(this.data, fn)
    return this
  }
  
  get() {
    return this.data
  }
}

new DataProcessor([1, 2, 3, 4, 5])
  |> _.filter(n => n > 2)
  |> _.transform(n => n * 3)
  |> _.get()
  -> log("Processed:")`,

            classes: `// Class definition
class Animal {
  constructor(name) {
    this.name = name
  }
  
  speak() {
    return \`\${this.name} makes a sound\`
  }
}

// Inheritance
class Dog extends Animal {
  constructor(name, breed) {
    super(name)
    this.breed = breed
  }
  
  speak() {
    return \`\${this.name} barks\`
  }
  
  getInfo() {
    return \`\${this.name} is a \${this.breed}\`
  }
}

let dog = new Dog("Max", "Golden Retriever")
log(dog.speak())
log(dog.getInfo())

// Method chaining
class StringBuilder {
  constructor() {
    this.str = ""
  }
  
  append(text) {
    this.str = this.str + text
    return this
  }
  
  toString() {
    return this.str
  }
}

let message = new StringBuilder()
  .append("Hello")
  .append(" ")
  .append("World!")
  .toString()

log("Built string:", message)`,

            async: `// Async functions
async function fetchData(id) {
  log(\`Fetching data for id: \${id}\`)
  await delay(100)
  return { id: id, name: \`Item \${id}\` }
}

// Async with error handling
async function safeOperation() {
  try {
    let result = await fetchData(1)
    log("Success:", result.name)
    return result
  } catch (error) {
    log("Error:", error)
    return null
  }
}

// Run async code
await safeOperation()

// Promise handling
Promise.resolve(42)
  .then(x => x * 2)
  .then(x => log("Promise result:", x))

// Parallel async operations
let ids = [1, 2, 3]
let promises = map(ids, id => fetchData(id))
let results = await Promise.all(promises)
log("All results:", results)`,

            destructuring: `// Array destructuring
let [first, second, ...rest] = [1, 2, 3, 4, 5]
log("First:", first)
log("Second:", second)
log("Rest:", rest)

// Object destructuring
let person = {
  name: "Alice",
  age: 30,
  city: "Boston"
}

let { name, age } = person
log(\`\${name} is \${age} years old\`)

// Nested destructuring
let data = {
  user: {
    profile: {
      firstName: "Bob",
      lastName: "Smith"
    }
  }
}

let { user: { profile: { firstName } } } = data
log("First name:", firstName)

// Rest in objects
let { x, y, ...coords } = { x: 1, y: 2, z: 3, w: 4 }
log("Remaining coordinates:", coords)`,

            optional: `// Optional chaining with objects
let user = {
  profile: {
    name: "Alice",
    address: {
      city: "Boston"
    }
  }
}

log("City:", user?.profile?.address?.city)
log("Missing:", user?.profile?.phone?.number)

// Optional chaining with arrays
let data = {
  items: [
    { title: "First" },
    { title: "Second" },
    null,
    { title: "Fourth" }
  ]
}

log("Item 0:", data.items?.[0]?.title)
log("Item 2:", data.items?.[2]?.title)
log("Item 10:", data.items?.[10]?.title)

// Dynamic index with optional chaining
let index = 1
log("Dynamic access:", data.items?.[index]?.title)

// Nullish coalescing
let value = null
let defaultValue = value ?? "default"
log("With null:", defaultValue)

let zero = 0
let zeroDefault = zero ?? "default"
log("With zero:", zeroDefault)

// Combined with optional chaining
let settings = {}
let theme = settings?.appearance?.theme ?? "light"
log("Theme:", theme)`,

            modules: `// This example shows module syntax
// (Note: In playground, modules are simulated)

// Import named exports
// import { helper, utils } from "./helpers"

// Export function
export function processData(data) {
  return map(data, x => x * 2)
}

// Export class
export class DataManager {
  constructor() {
    this.data = []
  }
  
  add(item) {
    push(this.data, item)
  }
  
  getAll() {
    return this.data
  }
}

// Using the exports
let manager = new DataManager()
manager.add("item1")
manager.add("item2")
log("Manager data:", manager.getAll())

let numbers = [1, 2, 3]
log("Processed:", processData(numbers))`
        };

        // Access Wang from the global UMD bundle
        const { WangInterpreter, InMemoryModuleResolver, WangValidator } = Wang;
        
        // Create globals for easy access
        window.interpreter = null;
        window.validator = new WangValidator();

        // Standard library functions
        const stdlib = {
            // I/O
            log: (...args) => {
                const output = document.getElementById('output');
                output.value += args.map(a => 
                    typeof a === 'object' ? JSON.stringify(a, null, 2) : String(a)
                ).join(' ') + '\n';
            },
            
            // Array methods
            filter: (arr, predicate) => arr.filter(predicate),
            map: (arr, fn) => arr.map(fn),
            reduce: (arr, fn, initial) => arr.reduce(fn, initial),
            forEach: (arr, fn) => arr.forEach(fn),
            find: (arr, predicate) => arr.find(predicate),
            some: (arr, predicate) => arr.some(predicate),
            every: (arr, predicate) => arr.every(predicate),
            push: (arr, ...items) => { arr.push(...items); return arr; },
            pop: (arr) => arr.pop(),
            shift: (arr) => arr.shift(),
            unshift: (arr, ...items) => { arr.unshift(...items); return arr; },
            slice: (arr, start, end) => arr.slice(start, end),
            sort: (arr, compareFn) => [...arr].sort(compareFn),
            reverse: (arr) => [...arr].reverse(),
            
            // Async utilities
            delay: (ms) => new Promise(resolve => setTimeout(resolve, ms)),
            Promise: Promise,
            
            // Type conversion
            String: String,
            Number: Number,
            Boolean: Boolean,
            Array: Array,
            Object: Object,
            
            // Math
            Math: Math,
            parseInt: parseInt,
            parseFloat: parseFloat,
            isNaN: isNaN,
            isFinite: isFinite,
            
            // JSON
            JSON: JSON
        };

        function setStatus(type, message) {
            const status = document.getElementById('status');
            const statusText = document.getElementById('status-text');
            
            status.style.display = 'flex';
            status.className = 'status ' + type;
            statusText.textContent = message;
            
            if (type !== 'loading') {
                setTimeout(() => {
                    status.style.display = 'none';
                }, 3000);
            }
        }

        window.runCode = async function() {
            const code = document.getElementById('editor').value;
            const output = document.getElementById('output');
            
            output.value = '';
            setStatus('loading', 'Running...');
            
            try {
                const resolver = new InMemoryModuleResolver();
                window.interpreter = new WangInterpreter({
                    moduleResolver: resolver,
                    functions: stdlib
                });
                
                const result = await interpreter.execute(code);
                
                if (result !== undefined) {
                    output.value += '→ ' + (typeof result === 'object' ? 
                        JSON.stringify(result, null, 2) : String(result)) + '\n';
                }
                
                setStatus('success', 'Executed successfully');
                
            } catch (error) {
                output.value = '❌ Error: ' + error.message + '\n';
                if (error.stack) {
                    output.value += '\nStack trace:\n' + error.stack;
                }
                
                setStatus('error', 'Execution failed');
            }
        };

        window.validateCode = function() {
            const code = document.getElementById('editor').value;
            const output = document.getElementById('output');
            
            output.value = '';
            setStatus('loading', 'Validating...');
            
            const result = validator.validate(code);
            
            if (result.valid) {
                output.value = '✅ Code is valid!\n\n';
                output.value += 'Statistics:\n';
                output.value += `- Lines: ${code.split('\n').length}\n`;
                output.value += `- Characters: ${code.length}\n`;
                
                setStatus('success', 'Valid Wang code');
                
            } else {
                output.value = '❌ Validation errors:\n\n';
                if (result.error) {
                    output.value += `Line ${result.error.line}, Column ${result.error.column}: ${result.error.message}\n`;
                    if (result.error.suggestion) {
                        output.value += '\n💡 Suggestion:\n' + result.error.suggestion + '\n';
                    }
                }
                
                setStatus('error', 'Invalid code');
            }
        };

        window.showAST = function() {
            const code = document.getElementById('editor').value;
            const output = document.getElementById('output');
            
            output.value = '';
            setStatus('loading', 'Generating AST...');
            
            const result = validator.validate(code, { includeAST: true });
            
            if (result.valid) {
                output.value = '🌳 Abstract Syntax Tree:\n\n';
                output.value += JSON.stringify(result.ast, null, 2);
                
                setStatus('success', 'AST generated');
                
            } else {
                output.value = '❌ Cannot generate AST - code has errors:\n\n';
                if (result.error) {
                    output.value += `Line ${result.error.line}, Column ${result.error.column}: ${result.error.message}\n`;
                }
                
                setStatus('error', 'Parse error');
            }
        };

        window.clearOutput = function() {
            document.getElementById('output').value = '';
        };

        window.loadExample = function(name) {
            const code = examples[name];
            if (code) {
                document.getElementById('editor').value = code;
                document.getElementById('examples').value = name;
                
                // Animate the editor
                const editor = document.querySelector('.panel');
                editor.style.transform = 'scale(0.98)';
                setTimeout(() => {
                    editor.style.transform = '';
                }, 200);
            }
        };

        // Handle example dropdown
        document.getElementById('examples').addEventListener('change', function(e) {
            if (e.target.value) {
                loadExample(e.target.value);
            }
        });

        // Run code on Ctrl+Enter
        document.getElementById('editor').addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                runCode();
            }
        });

        // Auto-resize textarea based on content (optional)
        const editor = document.getElementById('editor');
        const output = document.getElementById('output');

        // Add tab support to editor
        editor.addEventListener('keydown', function(e) {
            if (e.key === 'Tab') {
                e.preventDefault();
                const start = this.selectionStart;
                const end = this.selectionEnd;
                const value = this.value;
                
                this.value = value.substring(0, start) + '  ' + value.substring(end);
                this.selectionStart = this.selectionEnd = start + 2;
            }
        });
    </script>
</body>
</html>